<!DOCTYPE html>
  <html>
    <head>
      <!--Import Google Icon Font-->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

      <!--Let browser know website is optimized for mobile-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/><script src="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.js"></script>
      <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.5.1/firebaseui.css" />
    

    </head>

    <body>
      <!--Import jQuery before materialize.js-->
      <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
      <script type="text/javascript" src="js/materialize.min.js"></script>
         
    <!-- Sets up the main NavBar with the buttons and stuff -->
    <nav>
            <div class="nav-wrapper deep-purple lighten-2">
              <a href="#!" class="brand-logo center">SSTARtracking</a>
              <ul class="left hide-on-med-and-down">
                <!-- all the buttons you can click (each li) and what they link to (each href) -->
                <li><a href="about.html">About</a></li>
                <li><a href="home.html">Levels</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li class="active"><a href="login.html">Sign Up / Log In</a></li>
    
              </ul>
            </div>
        </nav>

      <nav>
        <div class="nav-wrapper blue lighten-3">
          <div class="col s12">
            <a href="home.html" class="breadcrumb">Home</a>
            <a href="contact.html" class="breadcrumb">Sign Up / Log In</a>
          </div>
        </div>
      </nav>
      <form>
          <div>
            <input id="email" type="text" placeholder="Email...">
          </div>
          <div>
            <input id="password" type="password" placeholder="Password...">
          </div>
          <div>
            <button id="register">Register</button>
            <button id="sign-in">Sign In</button>
            <button id="sign-out">Sign Out</button>
          </div>
        </form>
      
        <!--Include firebase.js  -->
        <script src="../firebaseui/dist/firebaseui.js"></script>
      <link type="text/css" rel="stylesheet" href="../firebaseui/dist/firebaseui.css" />
      
        
        <!--Configure firebase-->
        <script src="https://www.gstatic.com/firebasejs/4.11.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyACEN96s6abaTEkyNXQ6WawkWTZX6bTMPQ",
            authDomain: "starrtracking.firebaseapp.com",
            databaseURL: "https://starrtracking.firebaseio.com",
            projectId: "starrtracking",
            storageBucket: "starrtracking.appspot.com",
            messagingSenderId: "765759650270"
          };
          firebase.initializeApp(config);
        </script>
      
        <!--Handle auth events-->
        <!-- <script>
          firebase.auth().onAuthStateChanged(function(user) {
            window.user = user;
            // Step 1:
            //  If no user, sign in anonymously with firebase.auth().signInAnonymously()
            //  If there is a user, log out out user details for debugging purposes.
          });
        </script>
         -->
        <!--Handle page events-->
        <script>
          
          document.querySelector('#register').addEventListener('click',function (e){
            e.preventDefault();
            e.stopPropagation();
            var email = document.querySelector('#email').value;
            var password = document.querySelector('#password').value
            var credential = firebase.auth.EmailAuthProvider.credential(email, password);
            firebase.auth().createUserWithEmailAndPassword (email, password)
                  .then( function(user){
                  console.log("Successfully created user account: ", user.uid);
                  })
                  .catch(function(error){
                    console.log ('register error', error);
                    if (error.code === 'auth/email-already-in-use'){
                      var credential = firebase.auth.EmailAuthProvider.credential (email, password);
                      
                    }
            
          });
          document.querySelector('#sign-in').addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            var auth = firebase.auth();
            var currentUser = auth.currentUser;
            
            firebase.auth().signInWithEmailAndPassword (email, password)
                .then( function(user){
                  console.log("Sign in successful", user);
                  auth = user;
               })
                .catch (function(error){
                  var errorCode = error.code;
                  var errorMessage = error.message;
                  console.log ('signIn error', error);
                });
            // Step 2
            //  Get a credential with firebase.auth.emailAuthProvider.credential(emailInput.value, passwordInput.value)
            //  If there is no current user, log in with auth.signInWithCredential(credential)
            //  If there is a current user an it's anonymous, atttempt to link the new user with firebase.auth().currentUser.link(credential) 
            //  The user link will fail if the user has already been created, so catch the error and sign in.
          });
          
          document.querySelector('#sign-out').addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            firebase.auth().signOut();
          });
        })
      
          </script>
          
    </body>
  </html>


